---
title: "rbenchmark"
author: "Chang-Yu Chang"
date: "3/23/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

###rbenchmark and some small tricks
R have a package called `rbenchmark` which helps you estimate the computer time you use. Another similar package is `microbenchmark`.

```{r}
library(rbenchmark)
library(microbenchmark)
x <- c(1,1,1,2,4,6,7,1,4,3)
rbenchmark::benchmark(tabulate(x), table(x), replications=1000)
microbenchmark::microbenchmark(tabulate(x), table(x), times=1000L)
```
Both suggest `table` is around 30 times slower than `tabulate`. That's why I used `tabulate` for simulation.

Another trick is always creating the whole vector and replace each element, rather than `c()`, `rbind`, or `cbind` them. Check this

```{r}
rbenchmark::benchmark(method1 = {
  x <-  rep(0, 100)
  for (i in 1:1000) x[i] <- i
}, method2 = {
  x <- NULL
  for (i in 1:1000) x <- c(x, i)
}, replications=1000)

```

###Rcpp


```{r, engine='Rcpp', include=FALSE, echo=FALSE}
#include <Rcpp.h>

// [[Rcpp::export]]
int fibonacci(const int x) {
    if (x == 0 || x == 1) return(x);
    return (fibonacci(x - 1)) + fibonacci(x - 2);
}

```

