<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Chang-Yu Chang 張昌祐">

  
  
  
    
  
  <meta name="description" content="Simulation on generalized birthay problem using R">

  
  <link rel="alternate" hreflang="en-us" href="/2018/03/14/generalized-birthday-problem/">

  


  

  
  
  
  <meta name="theme-color" content="#795548">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.c22181911809d012a1d82f5f6ae01ae7.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.8825691770d993a274c817c412b512ba.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-132767541-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/2018/03/14/generalized-birthday-problem/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@changyu_chang">
  <meta property="twitter:creator" content="@changyu_chang">
  
  <meta property="og:site_name" content="Chang-Yu Chang 張昌祐">
  <meta property="og:url" content="/2018/03/14/generalized-birthday-problem/">
  <meta property="og:title" content="Generalized Birthday Problem | Chang-Yu Chang 張昌祐">
  <meta property="og:description" content="Simulation on generalized birthay problem using R"><meta property="og:image" content="/img/avatar.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-03-14T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-03-14T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#795548",
          "text": "hsla(16, 24%, 85%, 1)"
        },
        "button": {
          "background": "hsla(16, 24%, 85%, 1)",
          "text": "#795548"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>



  





  <title>Generalized Birthday Problem | Chang-Yu Chang 張昌祐</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Chang-Yu Chang 張昌祐</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/post"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact"><span>About</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/cv"><span>CV</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Generalized Birthday Problem</h1>

  

  
    



<meta content="2018-03-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2018-03-14 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Mar 14, 2018</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/2018/03/14/generalized-birthday-problem/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/r/">R</a>, <a href="/categories/simulation/">simulation</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/2018/03/14/generalized-birthday-problem/&amp;text=Generalized%20Birthday%20Problem" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/2018/03/14/generalized-birthday-problem/&amp;t=Generalized%20Birthday%20Problem" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Generalized%20Birthday%20Problem&amp;body=/2018/03/14/generalized-birthday-problem/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/2018/03/14/generalized-birthday-problem/&amp;title=Generalized%20Birthday%20Problem" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Generalized%20Birthday%20Problem%20/2018/03/14/generalized-birthday-problem/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/2018/03/14/generalized-birthday-problem/&amp;title=Generalized%20Birthday%20Problem" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<p>This project comes from the coding class I am taking this semester. The simplest birthday problem is as followed: how many people should be in a room such that the probability of a birthday shared by at least two persons is just above 0.5? I found this problem is very interesting. Throughout the process dealing this problem, some powerful R packages and essential coding skills are incorporated for more efficient simulation. In this project, I will try to address generalized birthday problem in an intuitive way (easy coding but computer expensive and slow) to somehow more advanced approaches.</p>
<div id="whats-probability-of-one-birthday-shared-by-two-persons-in-any-size-of-room" class="section level3">
<h3>What’s probability of one birthday shared by two persons in any size of room?</h3>
<p>The probability we are interested calculated such that a birthday shared by at least <em>k</em> persons. The targeted probability <em>p</em> here is 0.5. For each room size <em>i</em>, <em>r</em> replicates are tested.</p>
<p>In the following case, I did only 20 replicates.</p>
<pre class="r"><code>k &lt;- 2                # Birthday shared by k persons
p &lt;- 0.5              # Targetd probability
r &lt;- 20               # Replicates
result &lt;- rep(0, 100) # A vector for saving result 
i &lt;- 10                  # Room size</code></pre>
<p>Now here is trick. For each room size, create a single matrix that has <em>r</em> rows and <em>i</em> columns. The next step is to check by row: if there are at least <em>k=2</em> persons in one room (<em>i=10</em>) sharing the same birthday, return <code>TRUE</code>. Use <code>apply</code> to implicitly loop through each row. The result probability would be the sum of this vector divided by total replicate <em>r</em>.</p>
<pre class="r"><code>set.seed(12345)
birth &lt;- matrix(sample(1:365, r*i, replace=TRUE), nrow=r, ncol=i)
birth</code></pre>
<p>The probability for 2 persons sharing the same birthday in a room with 10 persones is roughly 0.1.</p>
<pre class="r"><code>sum(apply(birth, 1, function(x) max(tabulate(x))&gt;=k )) / r</code></pre>
<p>Now test different room sizes. Say I wanna test room sizes ranging from <em>k</em> to 100 (testing room size smaller than <em>k</em> is nonsense). Use <code>for</code> loop to go through room size from k to 100.</p>
<pre class="r"><code>k &lt;- 2                # Birthday shared by k persons
p &lt;- 0.5              # Targetd probability
r &lt;- 100000           # Replicates
result &lt;- rep(0, 100) # A vector for saving result 

system.time({         # Record time used
for (i in 1:100) {    # Test room sizes from 1 to 100 persons
  birth &lt;- matrix(sample(1:365, r*i, replace=TRUE), nrow=r, ncol=i)
  result[i] &lt;- sum(apply(birth, 1, function(x) max(tabulate(x))&gt;=k )) / r
}
})</code></pre>
<p>This simulation is extremely slow. Something is pretty obvious, for example, if I already know the result is going to be 23 just after calculating it, I don’t need to do the else (24-100), which consumes tons of time. For the rest of this post and maybe the other post, I will introduce some ways to speed up the simulation or make it more accurracy.</p>
<pre class="r"><code>plot(result, type=&quot;l&quot;, xlab=&quot;room size&quot;, ylab=&quot;probability&quot;, main=&quot;probability of a birthday shared by k persons&quot;)
abline(h=p, col=&quot;red&quot;) </code></pre>
<p>The answer is 23 persons.</p>
<pre class="r"><code>min(which(result&gt;p))</code></pre>
</div>
<div id="binary-search" class="section level3">
<h3>Binary search</h3>
<p>If I know where I stand is still far away from the target probability, can I apply a larger step, not step-by-step, in order to move quickly? A good way is to employ binary search algorithm. The key concept is to skip unecessary mid-points (in our case, room sizes) for saving computer time. Given a series of <em>n</em> sorted room sizes ranging from lower bound <span class="math inline">\(L=1\)</span> to upper bound <span class="math inline">\(R=n\)</span>, then the corresponding probability of at least k people sharing the same birthday are <span class="math inline">\(p_1, p_2, \dots, p_n\)</span>). Our goal is to find the probability of room size that is close and slightly large than 0.5 <span class="math inline">\(p_t=0.5\)</span>. Here is the procedure:</p>
<ol style="list-style-type: decimal">
<li>Set L to 1 and R to n. R would be always larger than L.</li>
<li>Calculate i (position fo the middle element). Set i to ceiling since the room size should be an integer.</li>
<li>If <span class="math inline">\(p_i&lt;p_t\)</span>, set L to i + 1 and go to step 2.</li>
<li>If <span class="math inline">\(p_i&gt;p_t\)</span>, set R to i − 1 and go to step 2.</li>
<li>Repeat step 2-4 until <span class="math inline">\(p_i=p_t\)</span>, the search is done. m is our answer.</li>
</ol>
<pre class="r"><code>gbp &lt;- function(k=2, p=.5, r=100000, threshold=.001) {
  i &lt;- k                       # Tested room size; start from k persons in a room
  x &lt;- 1                       # Counter for while loop
  L &lt;- 0                       # Lower bound for binary search
  R &lt;- k^4+100+sample(-k:k, 1) # Upper bound for binary search
  
  # Create an empty data frame for result
  result &lt;- setNames(data.frame(matrix(0, 100, 2)), c(&quot;room&quot;, &quot;p&quot;))
  
  while (abs(result$room[x] - p) &gt;= threshold) {
    # Test room size i
    i &lt;- ceiling((L+R)/2)
    result$room[x] &lt;- i
    
    # Calculate probability
    birth &lt;- matrix(sample(1:365, r*i, replace=TRUE), nrow=r, ncol=i)
    result$p[x] &lt;- sum(apply(birth, 1, function(x) max(tabulate(x))&gt;=k )) / r
    if (result$p[x] &gt;= p) R &lt;- i
    if (result$p[x] &lt; p) L &lt;- i
    
    # Break the loop if trapped
    if(sum(duplicated(tail(result$room[1:x], 2))) == 1 &amp; result$room[x] != 0) break
    
    # Print out room sizes tested
    cat(paste0(&#39;Room size tested:&#39;, i, &#39;\tprobability:&#39;, round(result$p[x], 3), &#39;\n&#39;))
    
    # Counter for steps
    x &lt;- x + 1          
  }
  ans &lt;- R
  return(list(answer=ans,
              result=result[1:x,]))
}

system.time(y&lt;-gbp(k=2, p=.5))</code></pre>
<p>Yes, I set the final <span class="math inline">\(R\)</span> as answer. The reason why <span class="math inline">\(R\)</span> is the correct answer rather than <span class="math inline">\(L\)</span> is because in the binary search algorithm, the middle point is always set to ceiling. If you set the middle point to floor, it is also true that <span class="math inline">\(R\)</span> is the right answer, because we want the simulated probability a bit <em>above</em> target probability.</p>
<pre class="r"><code>y</code></pre>
</div>
<div id="replicate-size" class="section level3">
<h3>Replicate size</h3>
<p>Same logic can be applied to replicate size. We only need to increase replicates size when close to the target probability. If we know there are still hundreds of rooms size between current roome size and ideal room size, simulating a room size for millions times seems to be bad idea. As we are getting closer to the ideal room size, accuracy becomes more and more important. Accuracy may not be a big deal when <em>k</em> is 2 or 3, since the ideal room size is small. However, for larger <em>k</em>, for example, 8, then the efficiency become important for the first few steps.</p>
<p>To gradually increase replicate size, a sigmoidal curve might be a good idea.</p>
<pre class="r"><code>B_l &lt;- 1000
B_u &lt;- 20000
x &lt;- 1:500
y &lt;- floor(-B_u/(1+exp(-.03* (x-200))))+(B_u+B_l)
plot(x, y, type=&#39;l&#39;, xlab=&#39;distance to ideal room size&#39;, ylab=&#39;replicate size&#39;)</code></pre>
<p>When we are approximately 400 persons away the ideal room size, just do 1000 replicates. Whereas almost being to the goal, try 20000 replicates. Then the function can be modified as followed.</p>
<pre class="r"><code>gbp &lt;- function(k=2, p=.5, B_l=1000, B_u=20000, threshold=.001) {
  i &lt;- k                       # Tested room size; start from k persons in a room
  x &lt;- 1                       # Counter for while loop
  L &lt;- 0                       # Lower bound for binary search
  R &lt;- k^4+100+sample(-k:k, 1) # Upper bound for binary search
  
  # Create an empty data frame for result
  result &lt;- setNames(data.frame(matrix(0, 100, 3)), c(&quot;room&quot;, &quot;p&quot;, &quot;replicate&quot;))
  
  while (abs(result$room[x] - p) &gt;= threshold) {
    # Increase replicate when approaching target room size
    r &lt;- floor(-B_u/(1+exp(-.03* ((R-L)-200))))+(B_u+B_l)
    result$replicate[x] &lt;- r
    
    # Test room size i
    i &lt;- ceiling((L+R)/2)
    result$room[x] &lt;- i 

    # Calculate probability
    birth &lt;- matrix(sample(1:365, r*i, replace=TRUE), nrow=r, ncol=i)
    result$p[x] &lt;- sum(apply(birth, 1, function(x) max(tabulate(x))&gt;=k )) / r
    if (result$p[x] &gt;= p) R &lt;- i
    if (result$p[x] &lt; p) L &lt;- i
    
    # Break the loop if trapped
    if(sum(duplicated(tail(result$room[1:x], 2))) == 1 &amp; result$room[x] != 0) break
    
    # Print out room sizes tested
    cat(paste0(&#39;Room size tested:&#39;, i, &#39;\tprobability:&#39;, round(result$p[x], 3), &#39;\treplicate size: &#39;, r, &#39;\n&#39;))
    
    # Counter for steps
    x &lt;- x + 1          
 }
  ans &lt;- R
  return(list(answer=ans,
              result=result[1:x,]))
}

system.time(y&lt;-gbp(k=8, p=.5))</code></pre>
<pre class="r"><code>y</code></pre>
<p>I will continue the rest of this project in another post.</p>
</div>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/r/">R</a>
  
  <a class="badge badge-light" href="/tags/simulation/">simulation</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/changyu/avatar_huc87b80bf149d3c142312366b6718e018_371968_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Chang-Yu Chang 張昌祐</a></h5>
      <h6 class="card-subtitle">PhD candidate in Ecology and Evolutionary Biology</h6>
      <p class="card-text" itemprop="description">I&rsquo;m a systems biologist and ecologist who loves programming.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/contact" >
              <i class="fas fa-paper-plane"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/changyu_chang" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.linkedin.com/in/chang-yu-chang-14bb199a/" target="_blank" rel="noopener">
              <i class="linkedin linkedin-linkedin"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/Chang-Yu-Chang" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://scholar.google.com/citations?user=vwkZIIMAAAAJ&amp;hl=en" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="http://orcid.org/0000-0003-3659-5256" target="_blank" rel="noopener">
              <i class="ai ai-orcid"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/2018/03/08/how-to-build-up-this-website/">How to build up this website?</a></li>
          
        </ul>
      </div>
      
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "changyuchang" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/javascript.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/markdown.min.js"></script>
        
      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//changyuchang.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.3394a224b26ce58ff36f44c54743e0ab.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
  </p>
  

  <p class="powered-by">
    &copy; Chang-Yu Chang, 2020 &middot; 

    Made with <i class="far fa-heart" style="color:#E13D3D"></i>, <a href="https://github.com/rbind/apreshill" target="_blank" rel="noopener"><i class="fas fa-code-branch" style="color:#E13D3D"></i></a>, the <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package, and the 
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
