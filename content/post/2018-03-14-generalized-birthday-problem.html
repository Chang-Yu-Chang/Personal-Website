---
title: Generalized Birthday Problem
author: Chang-Yu Chang
date: '2018-03-14'
slug: generalized-birthday-problem
categories:
  - R
tags:
  - fun
  - academic
  - R
---



<p>This tiny project comes from the coding class I am taking this semester. The simplest birthday problem is as followed: how many people should be in a room such that the probability of a birthday shared by at least two persons is just above 0.5? I found this problem is very interesting to be addressed, because upon the process, I have to use some powerful R packages and essential coding skills for simulation. In this project, I will try to address this problem step by step.</p>
<ul>
<li><p><a href="https://changyuchang.netlify.com/post/generalized-birthday-problem/#what&#39;s-probability-of-one-birthday-shared-by-two-persons-in-any-size-of-room?">What’s probability of one birthday shared by two persons in any size of room?</a></p></li>
<li><p><a href="https://changyuchang.netlify.com/post/generalized-birthday-problem/#rcpp">Rcpp</a></p></li>
<li><p><a href="https://changyuchang.netlify.com/post/generalized-birthday-problem/#rbenchmark">rbenchmark</a></p></li>
</ul>
<div id="whats-probability-of-one-birthday-shared-by-two-persons-in-any-size-of-room" class="section level3">
<h3>What’s probability of one birthday shared by two persons in any size of room?</h3>
<p>Say I wanna test 1000 replicates</p>
<pre class="r"><code>k &lt;- 2
p &lt;- 0.5
r &lt;- 100000
result &lt;- rep(0, 100)

system.time({
for (i in 1:100) {
  birth &lt;- matrix(sample(1:365, r*i, replace=TRUE), nrow=r, ncol=i)
  result[i] &lt;- sum(apply(birth, 1, function(x) max(tabulate(x))&gt;=k )) / r
}
})</code></pre>
<pre><code>##    user  system elapsed 
##  56.954   4.841  62.922</code></pre>
<p>This simulation is extremely slow in the sense of coding design. Something is pretty obvious, for example, if I already know the result is going to be 23 just after calculating it, I don’t need to do the else (24-100), which consumes tons of time. I will show you the many way that can speed up this simulation later. Here comes the goal for this in-class project: how to speed up the simulation process?</p>
<pre class="r"><code>plot(result, type=&quot;l&quot;, xlab=&quot;room size&quot;, ylab=&quot;probability&quot;, main=&quot;probability of a birthday shared by k persons&quot;)
abline(h=p, col=&quot;red&quot;) </code></pre>
<p><img src="/post/2018-03-14-generalized-birthday-problem_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The answer is 23 persons.</p>
<pre class="r"><code>min(which(result&gt;p))</code></pre>
<pre><code>## [1] 23</code></pre>
<p>(To be continued)</p>
</div>
